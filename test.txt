from pyspark.sql.types import NumericType
from pyspark.sql.functions import col

for field in df.schema.fields:
    if isinstance(field.dataType, NumericType):
        df = df.withColumn(
            field.name,
            col(field.name).cast("decimal(18,6)")
        )
from pyspark.sql.functions import col, round
from pyspark.sql.types import FloatType, DoubleType

df = df.select([
    col(c) if not isinstance(df.schema[c].dataType, (FloatType, DoubleType))
    else round(col(c), 6).cast("decimal(18,6)").alias(c)
    for c in df.columns
])
