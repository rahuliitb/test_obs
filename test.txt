from pyspark.sql.functions import col
from pyspark.sql.types import NumericType

df = df.select([
    col(c).cast("decimal(18,6)").alias(c)
    if isinstance(df.schema[c].dataType, NumericType)
    else col(c)
    for c in df.columns
])

from pyspark.sql.functions import col, round
from pyspark.sql.types import FloatType, DoubleType

df = df.select([
    col(c) if not isinstance(df.schema[c].dataType, (FloatType, DoubleType))
    else round(col(c), 6).cast("decimal(18,6)").alias(c)
    for c in df.columns
])
